{% extends "base_2.html" %} 
{% load static %} 
{% block style %}
<link rel="stylesheet" href="{% static 'css/consumer_home/consumer_main.css' %}"/>
{% endblock style %} 

{% block script %}
<script src="{% static 'js/consumer_home/consumer_profile.js' %}"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const csrftoken = '{{ csrf_token }}';

    const reviewModal = document.getElementById('review-modal');
    const reviewModalContent = document.getElementById('review-modal-content');

    // --- 1. ë¦¬ì›Œë“œ ì •ë³´ ë¡œë”© ë° UI ì—…ë°ì´íŠ¸ ë¡œì§ (ê¸°ì¡´ê³¼ ë™ì¼) ---
    const characterImages = {
        1: 'https://placehold.co/120x120/4caf50/ffffff?text=Lv.1',
        2: 'https://placehold.co/120x120/ff9800/ffffff?text=Lv.2',
        3: 'https://placehold.co/120x120/f44336/ffffff?text=Lv.3',
    };

    async function fetchRewardStatus() {
        try {
            const response = await fetch('/rewards/status/');
            if (!response.ok) throw new Error('ë¦¬ì›Œë“œ ì •ë³´ ë¡œë”© ì‹¤íŒ¨');
            const data = await response.json();
            updateRewardUI(data);
        } catch (error) {
            console.error('ë¦¬ì›Œë“œ ì •ë³´ ë¡œë”© ì˜¤ë¥˜:', error);
        }
    }

function updateRewardUI(data) {
        // ìºë¦­í„° ì´ë¯¸ì§€ ì—…ë°ì´íŠ¸
        const characterImage = document.getElementById('character-image');
        if (characterImage) characterImage.src = characterImages[data.character_level] || characterImages[1];

        // [ìˆ˜ì •ëœ ë¶€ë¶„] ë©”ë‹¬ ë“±ê¸‰ì— ë”°ë¥¸ ì„±ì¥ë¥  í”„ë¡œê·¸ë ˆìŠ¤ ë°” ì—…ë°ì´íŠ¸
        const medalToPercentage = {
            'NONE': 25,
            'BRONZE': 50,
            'SILVER': 75,
            'GOLD': 100
        };
        const growthPercentage = medalToPercentage[data.medal_tier] || 25; // ê¸°ë³¸ê°’ 25%

        const progressBar = document.getElementById('growth-progress-bar');
        const progressText = document.getElementById('growth-progress-text');

        if (progressBar && progressText) {
            progressBar.style.width = growthPercentage + '%';
            progressText.textContent = `ì„±ì¥ë¥ : ${growthPercentage}%`;
        }

        // ë©”ë‹¬ ìƒíƒœ ì—…ë°ì´íŠ¸
        const goldMedal = document.getElementById('medal-gold');
        const silverMedal = document.getElementById('medal-silver');
        const bronzeMedal = document.getElementById('medal-bronze');
        if (goldMedal) {
            goldMedal.textContent = 'ê¸ˆë©”ë‹¬'; silverMedal.textContent = 'ì€ë©”ë‹¬'; bronzeMedal.textContent = 'ë™ë©”ë‹¬';
            goldMedal.style.fontWeight = 'normal'; silverMedal.style.fontWeight = 'normal'; bronzeMedal.style.fontWeight = 'normal';
            if (data.medal_tier === 'GOLD') goldMedal.style.fontWeight = 'bold';
            if (data.medal_tier === 'SILVER') silverMedal.style.fontWeight = 'bold';
            if (data.medal_tier === 'BRONZE') bronzeMedal.style.fontWeight = 'bold';
        }

        // ìŠ¤íƒ¬í”„ ìƒíƒœ ì—…ë°ì´íŠ¸
        const stampsContainer = document.querySelector('.stamps');
        if (stampsContainer) {
            let stampsHTML = 'ìŠ¤íƒ¬í”„: ';
            for (let i = 0; i < 4; i++) {
                stampsHTML += (i < data.stamp_count) ? 'â—' : 'â—‹';
            }
            stampsContainer.textContent = stampsHTML;
        }
    }
    fetchRewardStatus(); // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰

    
 document.body.addEventListener('click', async function(event) {
        const target = event.target;

        // 'í”½ì—… ì™„ë£Œ' ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬
        if (target.classList.contains('pickup-complete-btn')) {
            const reservationId = target.dataset.pk;
            if (!confirm('í”½ì—…ì„ ì™„ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const url = `/reservations/${reservationId}/change-status/`;
            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'X-CSRFToken': csrftoken, 'X-Requested-With': 'XMLHttpRequest' }
                });
                const data = await response.json();
                if (data.status === 'success') {
                    window.location.reload();
                } else {
                    alert(data.message || 'ìƒíƒœ ë³€ê²½ ì‹¤íŒ¨');
                }
            } catch(error) {
                alert('ìƒíƒœ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        // 'ë¦¬ë·°ì“°ê¸°' ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬
        if (target.classList.contains('write-review-btn')) {
            const reservationId = target.dataset.pk;
            const storeName = target.dataset.storeName;
            openReviewModal(reservationId, storeName);
        }
        
        // 'ë¦¬ë·° ì‚­ì œ' ë²„íŠ¼ í´ë¦­ ì²˜ë¦¬ (ìƒˆë¡œ ì¶”ê°€)
        if (target.classList.contains('delete-review-btn')) {
            const reviewId = target.dataset.reviewId;
            if (confirm('ì •ë§ë¡œ ì´ ë¦¬ë·°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                handleReviewDelete(reviewId);
            }
        }

        // ëª¨ë‹¬ ë‹«ê¸° ë²„íŠ¼ ë˜ëŠ” ëª¨ë‹¬ ë°”ê¹¥ ì˜ì—­ í´ë¦­ ì²˜ë¦¬
        if (target.classList.contains('close-modal-btn') || target === reviewModal) {
            closeReviewModal();
        }
    });

    // --- ë¦¬ë·° ì‚­ì œë¥¼ ì„œë²„ì— ìš”ì²­í•˜ëŠ” í•¨ìˆ˜ (ìƒˆë¡œ ì¶”ê°€) ---
    async function handleReviewDelete(reviewId) {
        const url = `/reviews/${reviewId}/delete/`;
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: { 'X-CSRFToken': csrftoken, 'X-Requested-With': 'XMLHttpRequest' }
            });
            const data = await response.json();
            if (data.status === 'success') {
                document.getElementById(`review-card-${reviewId}`).remove();
                alert(data.message);
            } else {
                alert('ì˜¤ë¥˜: ' + data.message);
            }
        } catch (error) {
            console.error('Error:', error);
            alert('ë¦¬ë·° ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
    }
    // --- 3. ë¦¬ë·° ê´€ë ¨ í•¨ìˆ˜ë“¤ ---
    async function openReviewModal(reservationId, storeName) {
        try {
            const response = await fetch(`/reviews/create/${reservationId}/`);
            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.message || 'ë¦¬ë·° í¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
            }
            const formHtml = await response.text();
            
            if (reviewModalContent) {
                 reviewModalContent.innerHTML = `
                    <span class="close-modal" style="color:#aaa; float:right; font-size:28px; font-weight:bold; cursor:pointer;">&times;</span>
                    ${formHtml}
                `;
            }
            if (reviewModal) reviewModal.style.display = 'flex';
        } catch (error) {
            console.error('Error opening review modal:', error);
            alert(error.message);
        }
    }

    function closeReviewModal() {
        if (reviewModal) reviewModal.style.display = 'none';
    }

    // --- 4. ë¦¬ë·° í¼ ì œì¶œ ì´ë²¤íŠ¸ ì²˜ë¦¬ ---
    if (reviewModal) {
        reviewModal.addEventListener('submit', async function(event) {
            if (event.target.tagName === 'FORM') {
                event.preventDefault();
                const form = event.target;
                const formData = new FormData(form);

                try {
                    const response = await fetch(form.action, {
                        method: 'POST',
                        body: formData,
                        headers: { 'X-Requested-With': 'XMLHttpRequest', 'X-CSRFToken': csrftoken }
                    });
                    const result = await response.json();
                    
                    if (response.ok) {
                        alert(result.message);
                        window.location.reload();
                    } else {
                        throw new Error(result.message || 'ë¦¬ë·° ë“±ë¡ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                    }
                } catch (error) {
                    console.error('Error submitting review:', error);
                    alert(`ì˜¤ë¥˜: ${error.message}`);
                }
            }
        });
    }
});
</script>

{% endblock script %} 

{% block body %}
<div class="big_hugger">
    <div class="top-section">
        <!-- ìƒë‹¨ í”„ë¡œí•„ ì˜ì—­ -->
        <div class="profile-section">
            <div class="logo">
                <img src="{% static 'img/background.png' %}" alt="" />
                <img src="{% static 'img/background2.png' %}" alt="" />
            </div>
            <div class="welcome-box">
                <div class="backgroundimg">
                <img src="{% static 'img/Rounded rectangle.svg' %}" alt="" />
                </div>
                <div class="profile-info">
                    <!-- <img src="{% if request.user.profile_image %}{{ request.user.profile_image.url }}{% else %}/static/img/default_profile.png{% endif %}" alt="í”„ë¡œí•„ ì´ë¯¸ì§€" class="profile-img"> -->
                    <div class="profile-text">
                        <div class="textbox">
                        <span class="nickname-highlight"
                            ><span class="nickname">{{ request.user.username }}</span></span
                        >
                        <span class="welcome-text">ë‹˜ ë°˜ê°€ì›Œìš”!</span>
                        <img src="{% static 'img/emo1.png' %}" alt="" />
                        </div>

                        <div class="textbox1">
                            <div class="firstmsg">
                                ì˜¤ëŠ˜ ë­ ë¨¹ì„ê¹Œ?
                                <img src="{% static 'img/emo2.png' %}" alt="" class="pic" />
                            </div>
                            <div class="desc-text">
                                ê·¼ì²˜ <span class="green_small">ë…¸ì </span>ì—ì„œ
                                <span class="green_small">ì‹ ì„ í•˜ê²Œ</span> ì¥ë´ë´ìš”!
                            </div>
                            <div class="lastmsg">
                                <span class="desc-text">
                                ì§€ê¸ˆ ë‚´ ê·¼ì²˜, ì¥ë³´ëŠ” ê°€ì¥ ë”°ëœ»í•œ ë°©ë²• "</span>
                                <span class="farmfarm">íŒœíŒœ</span>"
                                <img src="{% static 'img/emo3.png' %}" alt="" class="pic" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="profile-box">
                    <img
                    src="{% static 'img/Union.png' %}"
                    alt=""
                    class="profile_hugger"
                    />
                <div class="profile-edit">
                    <img
                    id="profileImage"
                    src="{% if request.user.profile_image %}{{ request.user.profile_image.url }}{% else %}/static/img/default_profile.png{% endif %}"
                    alt="í”„ë¡œí•„"
                    />
                </div>
                <div class="level-box">
                    <p class="nickname">
                    {{ request.user.username }}
                    <img
                        id="editProfileBtn"
                        src="{% static 'img/edit.png' %}"
                        alt="ìˆ˜ì •"
                        style="cursor: pointer"
                    />
                    </p>
                    <p class="level">
                    LV.3
                    <img src="{% static 'img/level.png' %}" alt="" />
                    </p>
                </div>
            </div>
        </div>

        <!-- ëª¨ë‹¬ -->
        <div class="modal-overlay" id="editModal">
            <div class="modal-content">
                <form id="profileEditForm" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <div class="modal-actions">
                    <button id="closeModalBtn">Ã—</button>
                </div>
                <div class="nickname-row">
                <input type="text" id="nicknameInput" value="{{ request.user.username }}" name="username" />
                    <img
                        class="nickname-edit-btn"
                        src="{% static 'img/edit.png' %}"
                        alt="ë‹‰ë„¤ì„ ìˆ˜ì •" 
                    />
                </div>

                <div class="image-row">
                    <div class="image-preview">
                        <input type="file" name="profile_image" id="profileImageInput" style="display:none;">
                        <img
                        src="{% if request.user.profile_image %}{{ request.user.profile_image.url }}{% else %}/static/img/edit.png{% endif %}"
                        alt="í”„ë¡œí•„ ë¯¸ë¦¬ë³´ê¸°"
                        class="preview_img"
                        />
                        <img
                        class="image-edit-btn"
                        src="{% static 'img/edit.png' %}"
                        alt="ì´ë¯¸ì§€ ìˆ˜ì •"
                        />
                    </div>
                </div>
            </div>
        </div>
    </div>
        <div class="line"></div>
    </div>




    <div class="my-section">
        <h3>ë§ˆì´ ìºë¦­í„° ğŸ§¸</h3>
        <!-- ìºë¦­í„° ì •ë³´ ë“¤ì–´ê°ˆ ìë¦¬ -->
         <div class="character-display">
            <img id="character-image" src="https://placehold.co/120x120/3e3e3e/e0e0e0?text=Lv.1" alt="ìºë¦­í„°" width="120" height="120">
        </div>
         <div class="growth-progress">
            <div id="growth-progress-bar" class="progress-bar-inner"></div>
        </div>
        <p id="growth-progress-text" style="text-align:center; margin-top:5px; font-weight:bold;">ì„±ì¥ë¥ : 0%</p>
    </div>


    <div class="reward-section">
        <h3>ë¦¬ì›Œë“œ í˜„í™© ğŸ§©</h3>
        <!-- ë¦¬ì›Œë“œ ì •ë³´ ë“¤ì–´ê°ˆ ìë¦¬ -->
         <div class="reward-status">
            <div class="medals">
                <div id="medal-gold">Gold Medal</div>
                <div id="medal-silver">Silver Medal</div>
                <div id="medal-bronze">Bronze Medal</div>
            </div>
            <div class="stamps">
                <!-- JSê°€ ìŠ¤íƒ¬í”„ ê°œìˆ˜ë¥¼ ì±„ì›ë‹ˆë‹¤ -->
            </div>
        </div>
    </div>


    
    <!--ì˜ˆì•½í˜„í™© ì •ë³´-->
    <div class="res_section">
    <div class="character">
        ì˜ˆì•½ í˜„í™©
        <img
        src="{% static 'img/res_icon.png' %}"
        alt="ì˜ˆì•½ í˜„í™© ì•„ì´ì½˜"
        class="res_check"
        />
    </div>
    </div>
    <!--ì˜ˆì•½ í˜„í™© ìƒì„¸ ë‚´ìš©-->
    <div class="information_zone">
    <div class="res_res">
        <div class="information3-card">
        <div class="more">
            <a href="{% url 'reservations:list' %}"> <!-- 'reservationhome' -->
            <img
                src="{% static 'img/res_more.png' %}"
                alt="ì˜ˆì•½ í˜„í™© ë”ë³´ê¸°"
                class="res_more"
            />
            </a>
        </div>

        {% for r in active_reservations|slice:":3" %}
        <div class="back_detail" >
            {% for item in r.items.all %}
            <div class="details_img">
            {% if item.image %}
            <img
                src="{{ item.image.url }}"
                alt="{{ item.item_name }}"
                class="tomato"
            />
            {% else %}
            <img
                src="https://placehold.co/300x150/2a2a2a/cccccc?text={{ item.item_name|default:'ìƒí’ˆ' }}"
                alt="{{ item.item_name }}"
                class="tomato"
            />
            {% endif %}
            </div>
            <div class="details_txt">
            <span>
            íŒë§¤ì: {{ r.store.name }} <br>
            ìœ„ì¹˜: {{ r.store.address }} <br>
            íŒë§¤ ì‹œê°„: {{ r.store.sale_hours }} <br>
            ê°€ê²©:(ì´ {{ item.quantity }}ê°œ) {{ r.total_price }}ì› <br>
            ìƒíƒœ: {{ r.get_status_display }} <br>
            <span>
            </div>
            {% endfor %}

            <div>
            {% if r.status == 'PENDING' %}
                <span class="btn btn-dark">ìˆ˜ë½ ëŒ€ê¸°ì¤‘</span>

            {% elif r.status == 'ACCEPTED' %}
                {# 'ìˆ˜ë½' ìƒíƒœì¼ ë•Œ #}
                {% if r.remaining_minutes > 0 %}
                    <span class="btn btn-dark time-info">{{ r.remaining_minutes|floatformat:"0" }}ë¶„ í›„ í”½ì—… ê°€ëŠ¥</span>
                {% else %}
                    <button type="button" class="btn btn-success pickup-complete-btn" data-pk="{{ r.pk }}">í”½ì—… ì™„ë£Œ</button>
                {% endif %}

            {% elif r.status == 'PICKED_UP' %}
                {# 'í”½ì—… ì™„ë£Œ' ìƒíƒœì¼ ë•Œ #}
                <span style="color: green; font-weight: bold;">í”½ì—… ì™„ë£Œ</span>
                {% if not r.review %}
                    <button type="button" class="btn btn-light write-review-btn" data-pk="{{ r.pk }}" data-store-name="{{ r.store.name }}">ë¦¬ë·°ì“°ê¸°</button>
                {% else %}
                    <span class="btn btn-light" style="cursor: not-allowed; background-color: #e9ecef;">ë¦¬ë·° ì‘ì„± ì™„ë£Œ</span>
                {% endif %}

            {% elif r.status == 'REJECTED' %}
                {# 'ê±°ì ˆë¨' ìƒíƒœì¼ ë•Œ #}
                <span style="color: red; font-weight: bold;">ê±°ì ˆë¨</span>
                
            {% endif %}
            </div>
        </div>
        {% empty %}
            <p id="no-active-reservations" style="text-align:center; color: #aaa;">ì§„í–‰ ì¤‘ì¸ ì˜ˆì•½ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endfor %}
        </div>
    </div>
    </div>





    <!--êµ¬ë§¤ ë‚´ì—­ ì •ë³´-->
    <div class="buy_section">
        <div class="character1">
        êµ¬ë§¤ ë‚´ì—­
        <img src="{% static 'img/buy_icon.png' %}" alt="êµ¬ë§¤ ë‚´ì—­ ì•„ì´ì½˜" class="buy_icon" />
        <!--<a href="{% url 'reservations:purchase-list' %}" class="btn btn-light">êµ¬ë§¤ ë‚´ì—­ ì „ì²´ ë³´ê¸°</a>-->
        </div>

        <div class="information_zone">
        <div class="res_res">
            <section class="information4-card">

            <!-- ì¹´ë“œ ìŠ¤íƒ -->
            <div class="history_container">
                <!-- ì¹´ë“œ 1 : í™œì„± -->
                {% for r in past_reservations|slice:":3" %}
                <article class="history_card card--{{ forloop.counter }} {% if forloop.first %}active{% endif %}">
                <!-- ì¢Œ ì´ë¯¸ì§€ -->
                <div class="card_img">
                    {% with item=r.items.first %}
                    {% if item.image %}
                    <img src="{{ item.image.url }}" alt="{{ item.item_name }}" />
                    {% else %}
                    <img src="https://placehold.co/120x80/2a2a2a/cccccc?text={{ item.item_name|default:'ìƒí’ˆ' }}" alt="{{ item.item_name }}" />
                    {% endif %}
                    {% endwith %}
                </div>


                <!-- ìš°ì¸¡ ì´ˆë¡ íŒ¨ë„ -->
                <div class="panel">
                    <span class="date">{{ r.created_at|date:"Y.m.d" }}</span>
                    <h3>[{{ r.store.name }} | {{ r.store.seller.user.username }}]</h3>
                    <ul>
                    <li>í’ˆëª©: 
                        {% for item in r.items.all %}
                        {{ item.item_name }}{% if not forloop.last %}, {% endif %}
                        {% endfor %}
                    </li>
                    <li>ìœ„ì¹˜: {{ r.store.address }}</li>
                    <li>íŒë§¤ ì‹œê°„: {{ r.store.sale_hours }}</li>
                    <li>ê°€ê²©: {{ r.total_price }}ì›</li>
                    </ul>
                </div>
                {% empty %}
                <p id="no-past-reservations" style="text-align:center; color: #aaa;">ì§€ë‚œ ì˜ˆì•½ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>
                {% endfor %}
                </article>


                <!-- ë°˜ì‚¬ -->
                <div class="card_reflection" aria-hidden="true"></div>
            </div>

            <!-- ë”ë³´ê¸°/ë¦¬ì›Œë“œ (ì¹´ë“œ ìœ„ë¡œ ê²¹ì¹˜ì§€ ì•Šê²Œ ì½”ë„ˆë¡œ) -->
            <div class="more">
                <a href="{% url 'reservations:purchase-list' %}">
                <img src="{% static 'img/res_more.png' %}" alt="êµ¬ë§¤ ë‚´ì—­ ë”ë³´ê¸°" class="res_more" />
                <img src="{% static 'img/rew_gra.png' %}" alt="ë¦¬ì›Œë“œ í˜„í™© ì•„ì´ì½˜" class="rew_gra" />
                </a>
            </div>
            </section>
        </div>
        </div>
    </div>



    <!--ë¦¬ë·° ì •ë³´-->
    <div class="rev_section">
    <div class="character1">
        ë‚´ê°€ ì“´ ë¦¬ë·°
        <img
        src="{% static 'img/rev_icon.png' %}"
        alt="ë¦¬ë·° ì•„ì´ì½˜"
        class="rev_icon"
        />
    </div>

    <div class="review_hugger">
        <img
        src="{% static 'img/review_deco.png' %}"
        alt="ë¦¬ë·°ë°ì½”"
        class="review_deco"
        />
        
        {% for review in reviews %}
        <div class="per_review">
        <div class="reviewer_profile">
            <img
            src="{% if request.user.buyer.profile_image %}{{ request.user.buyer.profile_image.url }}{% else %}/static/img/default_profile.png{% endif %}"
            alt="ë‚´ í”„ë¡œí•„"
            class="r_profile_p"
            />
        </div>

        <div class="stars">
        {% for i in "12345" %}
            {% if forloop.counter <= review.rating %}
            <img src="{% static 'img/starscore_filled.png' %}" alt="ë³„ì " class="per_star"/>
            {% else %}
            <img src="{% static 'img/starscore.png' %}" alt="ë¹ˆ ë³„" class="per_star"/>
            {% endif %}
        {% endfor %}
        </div>
        <div class="r_store_info">
            <p><strong>[{{ review.store.name }}]</strong></p>
            <ul class="r_store_info_small">
                <li>ìœ„ì¹˜: {{ review.store.address }}</li>
                <li>íŒë§¤ ì‹œê°„: {{ review.store.sale_hours }}</li>
            </ul>
        </div>
        <div class="review_content">
            {{ review.content|truncatewords:20 }}
        </div>
        <div class="date">{{ review.created_at|date:"Y.m.d" }}</div>
        <!-- ì‚­ì œ ë²„íŠ¼ ì œì‘ í•„ìš” -->
        </div>
        {% empty %}
        <p style="text-align:center; color: #aaa;">ì‘ì„±í•œ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endfor %}
    </div>
    


    <!-- ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <div class="nav_box">
        {% if user.usertype == 'BUYER' %}
        <nav class="bottom_nav">
            <img src="{% static 'img/now_page.png' %}" alt="í˜„ì¬ í˜ì´ì§€" class="now_page">
            <div class="btn ">
            <a href="{% url 'stores:map' %}">
                <img src="{% static 'img/map_page_black.png' %}" alt="ì§€ë„í˜ì´ì§€" class="map_page">
            </a>
            </div>
            <div class="btn selected_nav">
            <a href="{% url 'users:buyer_home' %}">
                <img src="{% static 'img/home_page_gray.png' %}" alt="í™ˆí˜ì´ì§€" class="home_page">
            </a>
            </div>
            <div class="btn">
            <a href="{% url 'shopping:ai_shopping' %}">
                <span class="shopping_page">AI</span>
            </a>
            </div>
        </nav>
        {% elif user.usertype == 'SELLER' %}
        <nav class="bottom_nav">
            <img src="{% static 'img/now_page.png' %}" alt="í˜„ì¬ í˜ì´ì§€" class="now_page">
            <div class="btn">
            <a href="{% url 'stores:map' %}">
                <img src="{% static 'img/map_page_gray.png' %}" alt="ì§€ë„í˜ì´ì§€" class="map_page">
            </a>
            </div>
            <div class="btn selected_nav">
            <a href="{% url 'users:seller_home' %}">
                <img src="{% static 'img/home_page_black.png' %}" alt="í™ˆí˜ì´ì§€" class="home_page">
            </a>
            </div>
            <div class="btn">
            <a href="{% url 'reservations:seller_list' %}">
                <span class="shopping_page">ì˜ˆì•½</span>
            </a>
            </div>
        </nav>
        {% endif %}
    </div>
</div>
</div>










<div id="review-modal" class="modal">
  <div class="modal-content">
    <div id="review-modal-content">
      </div>
  </div>
</div>
{% endblock body %}