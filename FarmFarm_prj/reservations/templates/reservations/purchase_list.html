{% extends "base_2.html" %} {% load static %} {% block style %}
<link
  rel="stylesheet"
  href="{% static 'css/consumer_home/history_home.css' %}"
/>
{% endblock style %} {% block body %}
<div class="big_hugger">
  <div class="historye-home">
    <!-- 구매 내역 카드 스택 -->
    <section class="information4-card">
      <!-- 상단: 뒤로가기 + 데코 -->
      <div class="top-section">
        <a href="{% url 'users:buyer_home' %}">
          <img src="{% static 'img/exit.png' %}" alt="나가기" class="exit" />
        </a>
        <img
          src="{% static 'img/cha_gra2.png' %}"
          alt="상세화면 상단 데코"
          class="cha_gra"
        />
        <img
          src="{% static 'img/cha_gra22.png' %}"
          alt="상세화면 상단 데코2"
          class="cha_gra2"
        />
      </div>

      <div class="history_container">
        <!-- 카드 1 -->
        {% for r in past_reservations %}
        <article class="history_card card--{{ forloop.counter }}">
          <div class="card_img">
            {% with item=r.items.first %}
              {% if item.image %}
                <img src="{{ item.image.url }}" alt="{{ item.item_name }}" />
              {% else %}
                <img src="https://placehold.co/120x80/2a2a2a/cccccc?text={{ item.item_name|default:'상품' }}" alt="{{ item.item_name }}" />
              {% endif %}
            {% endwith %}
          </div>

          <div class="text_box">
            <span class="date">{{ r.created_at|date:"Y.m.d" }}</span>
            <h3>[{{ r.store.name }} | {{ r.store.seller.user.username }}]</h3>
            <ul>
              <li>품목: 
                  {% for item in r.items.all %}
                  {{ item.item_name }}{% if not forloop.last %}, {% endif %}
                  {% endfor %}
              </li>
              <li>위치: {{ r.store.address }}</li>
              <li>판매 시간: {{ r.store.sale_hours }}</li>
              <li>가격: {{ r.total_price }}원</li>
            </ul>
          </div>
        </article>
          {% empty %}
            <p id="no-past-reservations" style="text-align:center; color: #aaa;">지난 예약 내역이 없습니다.</p>
          {% endfor %}

        <div class="card_reflection" aria-hidden="true"></div>
      </div>
    </section>

    <!-- 네비게이션 바 -->
    <div class="nav_box">
        {% if user.usertype == 'BUYER' %}
        <nav class="bottom_nav">
            <img src="{% static 'img/now_page.png' %}" alt="현재 페이지" class="now_page">
            <div class="btn">
            <a href="{% url 'stores:map' %}">
                <img src="{% static 'img/map_page_gray.png' %}" alt="지도페이지" class="map_page">
            </a>
            </div>
            <div class="btn selected_nav">
            <a href="{% url 'users:buyer_home' %}">
                <img src="{% static 'img/home_page_black.png' %}" alt="홈페이지" class="home_page">
            </a>
            </div>
            <div class="btn">
            <a href="{% url 'shopping:ai_shopping' %}">
                <span class="shopping_page">AI</span>
            </a>
            </div>
        </nav>
        {% elif user.usertype == 'SELLER' %}
        <nav class="bottom_nav">
            <img src="{% static 'img/now_page.png' %}" alt="현재 페이지" class="now_page">
            <div class="btn">
            <a href="{% url 'stores:map' %}">
                <img src="{% static 'img/map_page_gray.png' %}" alt="지도페이지" class="map_page">
            </a>
            </div>
            <div class="btn">
            <a href="{% url 'users:seller_home' %}">
                <img src="{% static 'img/home_page_black.png' %}" alt="홈페이지" class="home_page">
            </a>
            </div>
            <div class="btn">
            <a href="{% url 'reservations:seller_list' %}">
                <span class="shopping_page">예약</span>
            </a>
            </div>
        </nav>
        {% endif %}
    </div>
  </div>
</div>
{% endblock body %}
