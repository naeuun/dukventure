{% extends "base_2.html" %} {% load static %} {% block style %}
<link
  rel="stylesheet"
  href="{% static 'css/consumer_home/reservation_home.css' %}"
/>
{% endblock style %} {% block body %}
<div class="page">
  <!-- 상단바 -->
  <header class="topbar">
    <a href="{% url 'users:buyer_home' %}" class="back-btn" aria-label="뒤로가기">
      <img src="{% static 'img/cha_exit.png' %}" alt="뒤로가기" />
    </a>
    <div class="leaf-row">
      <img src="{% static 'img/res_gra2.png' %}" alt="장식" />
    </div>
  </header>

  <main class="content">
    {% for r in reservations %}
    <section class="card card--hero">
        <div class="card__image">
        {% with item=r.items.first %}
            {% if item.image %}
            <img src="{{ item.image.url }}" alt="{{ item.item_name }}" />
            {% else %}
            <img src="https://placehold.co/120x80/2a2a2a/cccccc?text={{ item.item_name|default:'상품' }}" alt="{{ item.item_name }}" />
            {% endif %}
        {% endwith %}
        </div>

        <div class="card__info">
        <ul>
            <li>판매자: {{ r.store.seller.user.username }}</li>
            <li>위치: {{ r.store.address }}</li>
            <li>판매 시간: {{ r.store.sale_hours }}</li>
            <li>가격: {{ r.total_price }}원</li>
            <li>
            개수:
            {% with first_item=r.items.all|first %}
                {{ first_item.quantity }}{{ first_item.unit }}
            {% endwith %}
            </li>
            <li>상태: {{ r.get_status_display }}</li>
        </ul>
        </div>
    </section>

    <div class="card-actions-row">
        <button class="btn btn-lime" id="btn-finish">픽업 완료</button>
        <button class="btn btn-black" id="btn-review">리뷰쓰기</button>
    </div>
    {% endfor %}
    </main>

    
    <!-- 카드 2 버튼(예시) -->
    {% comment %} <div class="card-actions-row">
      <button class="btn btn-black">10분후 픽업가능</button>
      <button class="btn btn-lime">픽업 전</button>
    </div>
  </main>
</div> {% endcomment %}

<!-- 리뷰작성 모달 -->
<div id="reviewModal" class="modal" aria-hidden="true">
  <div
    class="modal__panel"
    role="dialog"
    aria-modal="true"
    aria-label="리뷰작성"
  >
    <div class="modal__head">
      <div class="modal__title">리뷰작성</div>
      <div class="modal__head-actions">
        <button
          type="button"
          value="이미지 변경"
          class="change_photo_btn"
          id="changePhotoBtn"
          aria-label="이미지 변경"
        >
          <img
            src="{% static 'img/add_photo.png' %}"
            alt="이미지 변경"
            class="change_photo"
            id="changePhotoImg"
          />
        </button>
        <input type="file" id="reviewPhoto" accept="image/*" hidden />
        <button class="modal__close" id="modalCloseBtn" aria-label="닫기">
          ×
        </button>
      </div>
    </div>

    <div class="modal__stars">★★★★★</div>

    <div class="modal__textarea-wrap">
      <textarea class="modal__input" placeholder="입력하세요..."></textarea>
    </div>

    <div class="modal__keyword-head">
      <span class="chip-title">#키워드</span>
    </div>

    <div class="modal__keywords">
      <button class="tag">#신선해요</button>
      <button class="tag">#저렴해요</button>
      <button class="tag">#친절해요</button>
      <button class="tag">#국내산</button>
      <button class="tag">#매일판매</button>
      <button class="tag">#덤이있어요</button>
      <button class="tag">#정직해요</button>
      <button class="tag">#한정판매</button>
      <button class="tag">#수확직송</button>
    </div>

    <button class="btn btn-lime modal__submit">입력완료</button>
  </div>
</div>
<!-- 네비게이션 -->
    <div class="nav_box">
        {% if user.usertype == 'BUYER' %}
        <nav class="bottom_nav">
            <img src="{% static 'img/now_page.png' %}" alt="현재 페이지" class="now_page">
            <div class="btn"><a href="{% url 'stores:map' %}"><img src="{% static 'img/map_page_gray.png' %}" alt="지도페이지" class="map_page"></a></div>
            <div class="btn selected_nav"><a href="{% url 'users:buyer_home' %}"><img src="{% static 'img/home_page_black.png' %}" alt="홈페이지" class="home_page"></a></div>
            <div class="btn"><a href="{% url 'shopping:ai_shopping' %}"><span class="shopping_page">AI</span></a></div>
        </nav>
        {% elif user.usertype == 'SELLER' %}
        <nav class="bottom_nav">
            <img src="{% static 'img/now_page.png' %}" alt="현재 페이지" class="now_page">
            <div class="btn"><a href="{% url 'stores:map' %}"><img src="{% static 'img/map_page_gray.png' %}" alt="지도페이지" class="map_page"></a></div>
            <div class="btn selected_nav"><a href="{% url 'users:seller_home' %}"><img src="{% static 'img/home_page_black.png' %}" alt="홈페이지" class="home_page"></a></div>
            <div class="btn"><a href="{% url 'reservations:seller_list' %}"><span class="shopping_page">예약</span></a></div>
        </nav>
        {% endif %}
        </div>
    </div>
{% endblock body %} {% block script %}
<script src="{% static 'js/consumer_home/reservation_home.js' %}"></script>
{% endblock script %}
